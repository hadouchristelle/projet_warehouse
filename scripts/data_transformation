----- data transformation 

use DataWarehouse;

select*
from(
select* ,
 ROW_NUMBER() OVER(PARTITION BY cst_id ORDER BY cst_create_date desc) as flag_last
from bronze.crm_customer)t where flag_last = 1 AND cst_id =29466;

----- check for unwanted spaces 
select cst_gndr
from bronze.crm_customer
where cst_gndr != TRIM ( cst_gndr);

----- making the transformation

select cst_id,
cst_key,
TRIM(cst_firstname) AS cst_firstname,
TRIM(cst_lastname) as cst_last_name,
cst_material_status,
cst_gndr,
cst_create_date
from (
select* ,
 ROW_NUMBER() OVER(PARTITION BY cst_id ORDER BY cst_create_date desc) as flag_last
from bronze.crm_customer)t where flag_last = 1 ;

--------data standardization & consistency
